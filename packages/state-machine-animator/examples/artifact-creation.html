<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artifact Creation - State Machine Animator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    h1 {
      color: #2c3e50;
      margin-bottom: 10px;
    }

    .description {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .animation-container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      overflow: hidden;
    }

    #animation {
      width: 100%;
      height: 500px;
    }

    .controls {
      display: flex;
      gap: 10px;
      padding: 15px;
      background: #f8f9fa;
      border-top: 1px solid #e0e0e0;
    }

    button {
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s;
    }

    button:hover {
      background: #43a047;
    }

    button:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
    }

    .info-box {
      background: #e8f5e9;
      border-left: 4px solid #4caf50;
      padding: 15px;
      border-radius: 4px;
      margin-top: 20px;
    }

    .info-box h3 {
      color: #2e7d32;
      margin-bottom: 8px;
    }

    .info-box p {
      color: #555;
      line-height: 1.6;
    }

    .tip {
      text-align: center;
      color: #999;
      font-size: 12px;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Artifact Creation Animation</h1>
    <p class="description">
      This animation demonstrates how a tool call can create an external artifact
      (like a PDF document or report) that stays attached to the interaction.
      As more states are pushed onto the stack, the artifact moves along with
      the interaction that created it.
    </p>

    <div class="animation-container">
      <div id="animation"></div>
      <div class="controls">
        <button id="play-btn">Play Animation</button>
        <button id="reset-btn">Reset</button>
      </div>
    </div>

    <div class="info-box">
      <h3>About Artifacts</h3>
      <p>
        Artifacts are external outputs created by tool calls during agent execution.
        They represent tangible results like generated documents, images, data exports,
        or code files. Unlike transient tool results, artifacts persist and can be
        referenced later in the interaction. The visual attachment (arrow) shows which
        interaction created the artifact, maintaining context as the conversation progresses.
      </p>
    </div>

    <p class="tip">Drag to pan, scroll to zoom</p>
  </div>

  <script type="module">
    import { StateMachineAnimator } from '../dist/state-machine-animator.js';

    const animator = new StateMachineAnimator({
      container: '#animation',
      theme: 'light',
      responsive: true,
    });

    const playBtn = document.getElementById('play-btn');
    const resetBtn = document.getElementById('reset-btn');

    async function runAnimation() {
      playBtn.disabled = true;

      await animator.playArtifactCreation({
        stack: {
          id: 'main',
          label: 'Report Agent',
          states: [],
        },
        preStates: [
          { type: 'TaskDefinition', label: 'Generate sales report' },
          { type: 'AskOracle', label: 'How should I proceed?' },
          { type: 'OracleResponse', label: 'Analyzing sales data...' },
          { type: 'ToolCall', label: 'query_database' },
          { type: 'ToolResult', label: '1,234 records found' },
        ],
        creatorState: { type: 'ToolCall', label: 'generate_pdf_report' },
        artifact: {
          id: 'report',
          name: 'Q4 Sales Report',
          type: 'document',
          extension: 'pdf',
        },
        resultState: { type: 'ToolResult', label: 'Report generated' },
        postStates: [
          { type: 'AskOracle', label: 'What else should I do?' },
          { type: 'OracleResponse', label: 'Task complete, report ready' },
          { type: 'TaskResult', label: 'Report delivered to user' },
        ],
        options: {
          artifactPosition: 'right',
        },
      });

      playBtn.disabled = false;
    }

    playBtn.addEventListener('click', runAnimation);

    resetBtn.addEventListener('click', () => {
      animator.reset();
      playBtn.disabled = false;
    });

    // Run initial animation
    runAnimation();
  </script>
</body>
</html>
